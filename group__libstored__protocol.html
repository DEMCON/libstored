<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libstored: protocol</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libstored
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__libstored__protocol.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">protocol<div class="ingroups"><a class="el" href="group__libstored.html">libstored</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Protocol layers, to be wrapped around a <a class="el" href="classstored_1_1_debugger.html" title="The application-layer implementation of the Embedded Debugger protocol. ">stored::Debugger</a> instance.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstored_1_1_ascii_escape_layer.html">stored::AsciiEscapeLayer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Escape non-ASCII bytes.  <a href="classstored_1_1_ascii_escape_layer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstored_1_1_protocol_layer.html">stored::ProtocolLayer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protocol layer base class.  <a href="classstored_1_1_protocol_layer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstored_1_1_terminal_layer.html">stored::TerminalLayer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts and injects Embedded <a class="el" href="classstored_1_1_debugger.html" title="The application-layer implementation of the Embedded Debugger protocol. ">Debugger</a> messages in a stream of data, such as a terminal.  <a href="classstored_1_1_terminal_layer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstored_1_1_zmq_layer.html">stored::ZmqLayer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A protocol layer that wraps the protocol stack and implements ZeroMQ REQ/REP around it.  <a href="classstored_1_1_zmq_layer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Protocol layers, to be wrapped around a <a class="el" href="classstored_1_1_debugger.html" title="The application-layer implementation of the Embedded Debugger protocol. ">stored::Debugger</a> instance. </p>
<p>Every embedded device is different, so the required protocol layers are too. What is common, is the Application layer, but as the Transport and Physical layer are often different, the layers in between are often different too. To provide a common Embedded Debugger interface, the client (e.g., GUI, CLI, python scripts), we standardize on ZeroMQ REQ/REP over TCP.</p>
<p>Not every device supports ZeroMQ, or even TCP. For this, several bridges are required. Different configurations may be possible:</p>
<ul>
<li>In case of a Linux/Windows application: embed ZeroMQ server into the application, such that the application binds to a REP socket. A client can connect to the application directly.</li>
<li>Terminal application with only stdin/stdout: use escape sequences in the stdin/stdout stream. <code><a class="el" href="stdio__wrapper_8py.html" title="A stdin/stdout frame grabber to ZmqServer wrapper for a to-be-started process. ">client/stdio_wrapper.py</a></code> is provided to inject/extract these messages from those streams and prove a ZeroMQ interface.</li>
<li>Application over CAN: like a <code><a class="el" href="stdio__wrapper_8py.html" title="A stdin/stdout frame grabber to ZmqServer wrapper for a to-be-started process. ">client/stdio_wrapper.py</a></code>, a CAN extractor to ZeroMQ bridge is required.</li>
</ul>
<p>Then, the client can be connected to the ZeroMQ interface. The following clients are provided:</p>
<ul>
<li><code>client/ed2.ZmqClient</code>: a python class that allows easy access to all objects of the connected store. This is the basis of the clients below.</li>
<li><code><a class="el" href="cli__client_8py.html" title="A Command line interface client to enter Embedded Debugger commands. ">client/cli_client.py</a></code>: a command line tool that lets you directly enter the protocol messages as defined above.</li>
<li><code><a class="el" href="gui__client_8py.html" title="A Pyside2/QtQuick GUI client. ">client/gui_client.py</a></code>: a simple GUI that shows the list of objects and lets you manipulate the values. The GUI has support to send samples to <code>lognplot</code>.</li>
</ul>
<p>Test it using the <code>terminal</code> example, started using the <code><a class="el" href="stdio__wrapper_8py.html" title="A stdin/stdout frame grabber to ZmqServer wrapper for a to-be-started process. ">client/stdio_wrapper.py</a></code>. Then connect one of the clients above to it.</p>
<h3>Application layer</h3>
<p>See <a class="el" href="group__libstored__debugger.html">debugger</a>.</p>
<h3>Presentation layer</h3>
<p>For terminal or UART: In case of binary data, escape all bytes &lt; 0x20 as follows: the sequence <code>DEL</code> (0x7f) removes the 3 MSb of the successive byte. For example, the sequence <code>DEL ;</code> (0x7f 0x3b) decodes as <code>ESC</code> (0x1b). To encode <code>DEL</code> itself, repeat it. See <a class="el" href="classstored_1_1_ascii_escape_layer.html" title="Escape non-ASCII bytes. ">stored::AsciiEscapeLayer</a>.</p>
<p>For CAN/ZeroMQ: nothing required.</p>
<h3>Session layer:</h3>
<p>For terminal/UART/CAN: no session support, there is only one (implicit) session.</p>
<p>For ZeroMQ: use REQ/REP sockets, where the application-layer request and response are exactly one ZeroMQ message. All layers below are managed by ZeroMQ.</p>
<h3>Transport layer</h3>
<p>For terminal or UART: out-of-band message are captured using <code>ESC _</code> (APC) and <code>ESC \</code> (ST). A message consists of the bytes in between these sequences. See <a class="el" href="classstored_1_1_terminal_layer.html" title="Extracts and injects Embedded Debugger messages in a stream of data, such as a terminal. ">stored::TerminalLayer</a>.</p>
<p>In case of lossly channels (UART/CAN), CRC, message sequence number, and retransmits should be implemented. This depends on the specific transport hardware and embedded device.</p>
<h3>Network layer</h3>
<p>For terminal/UART/ZeroMQ, nothing has to be done.</p>
<p>For CAN: packet fragmentation/reassembling/routing is done here.</p>
<h3>Datalink layer</h3>
<p>Depends on the device.</p>
<h3>Physical layer</h3>
<p>Depends on the device. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
